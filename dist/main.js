(()=>{"use strict";var t=[48,48],e={87:!1,65:!1,83:!1,68:!1,16:!1},n={},o={},r={},i={},s=["DLRU","DLR","DLU","LRU","DRU","DL","DR","DU","LR","LU","RU","D","L","R","U"],a={4:{4:45,3:45,2:9,1:1},3:{3:70,2:25,1:5},2:{2:60,1:40}},u={};function h(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=t&&("undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"]);if(null!=n){var o,r,i=[],s=!0,a=!1;try{for(n=n.call(t);!(s=(o=n.next()).done)&&(i.push(o.value),!e||i.length!==e);s=!0);}catch(t){a=!0,r=t}finally{try{s||null==n.return||n.return()}finally{if(a)throw r}}return i}}(t,e)||function(t,e){if(t){if("string"==typeof t)return c(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?c(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}function l(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}const f=function(){function t(e,n,o){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.entity=e,this.width=n,this.height=o,this.pos=this.originPos();var r=h(this.pos,2),i=r[0],s=r[1],a=this.pos,u=[i+n,s],c=[i+n,s+o],l=[i,s+o];this.center=[i+n/2,s+o/2],this.top=[[a[0],u[0]],a[1]],this.bottom=[[l[0],c[0]],l[1]],this.right=[u[0],[u[1],c[1]]],this.left=[a[0],[a[1],l[1]]],this.sides=[this.top,this.bottom,this.right,this.left]}var e,n;return e=t,(n=[{key:"draw",value:function(t){t.strokeStyle="transparent",t.strokeRect(this.pos[0],this.pos[1],this.width,this.height)}},{key:"updateSides",value:function(){var t=h(this.pos,2),e=t[0],n=t[1],o=this.pos,r=[e+this.width,n],i=[e+this.width,n+this.height],s=[e,n+this.height];this.center=[e+this.width/2,n+this.height/2],this.top=[[o[0],r[0]],o[1]],this.bottom=[[s[0],i[0]],s[1]],this.right=[r[0],[r[1],i[1]]],this.left=[o[0],[o[1],s[1]]]}},{key:"originPos",value:function(){var t=[this.entity.pos[0],this.entity.pos[1]],e=t[0],n=t[1],o=[this.entity.width,this.entity.height],r=o[0],i=o[1],s=[this.width,this.height];return[e+(r-s[0])/2,n+i-s[1]]}},{key:"centerOnEntity",value:function(){this.pos=this.entity.colBoxHook(),this.updateSides()}}])&&l(e.prototype,n),t}();function p(t,e){if(t){if("string"==typeof t)return d(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?d(t,e):void 0}}function d(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}function y(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}const m=function(){function t(e,n,o){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.width=n,this.height=o,this.pos=e;var r,i,s=(r=this.pos,i=2,function(t){if(Array.isArray(t))return t}(r)||function(t,e){var n=t&&("undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"]);if(null!=n){var o,r,i=[],s=!0,a=!1;try{for(n=n.call(t);!(s=(o=n.next()).done)&&(i.push(o.value),!e||i.length!==e);s=!0);}catch(t){a=!0,r=t}finally{try{s||null==n.return||n.return()}finally{if(a)throw r}}return i}}(r,i)||p(r,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),a=s[0],u=s[1],h=this.pos,c=[a+this.width,u],l=[a+this.width,u+this.height],f=[a,u+this.height];this.top=[[h[0],c[0]],h[1]],this.bottom=[[f[0],l[0]],f[1]],this.right=[c[0],[c[1],l[1]]],this.left=[h[0],[h[1],f[1]]]}var e,n;return e=t,(n=[{key:"draw",value:function(t){var e;t.beginPath(),t.fillStyle="#transparent",t.fillRect.apply(t,(e=this.pos,function(t){if(Array.isArray(t))return d(t)}(e)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(e)||p(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()).concat([this.width,this.height]))}}])&&y(e.prototype,n),t}();function b(t){return function(t){if(Array.isArray(t))return v(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return v(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?v(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function v(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}function w(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}const g=function(){function t(e){var o,r,s,a,u=this;if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.coins=W(),this.walls=[],this.neighbors={up:void 0,down:void 0,left:void 0,right:void 0},e){var h=Object.keys(e)[0],c=Object.values(e)[0];switch(this.nodePos=b(c.nodePos),h){case"up":this.neighbors.down=c,r="D",this.nodePos[1]++;break;case"down":this.neighbors.up=c,r="U",this.nodePos[1]--;break;case"left":this.neighbors.right=c,r="R",this.nodePos[0]--;break;case"right":this.neighbors.left=c,r="L",this.nodePos[0]++}}else this.nodePos=[0,0];n["".concat(this.nodePos)]=this,q(this);var l=[],f=z(this),p=f.split("");if(e)if(p=p.filter((function(t){return t!==r})),(a=Y(f.length))===f.length){var d;o=Math.floor(3*Math.random()),this.background=i["".concat(a).concat(f).concat(o)],this.background,$(this,f),s=H(f),(d=this.walls).push.apply(d,b(s)),n["".concat(this.nodePos)]=this}else{var y;G(p),l.push(r),a--;for(var m=0;m<a;m++)l.push(p.pop());l=l.sort().join(""),o=Math.floor(3*Math.random()),this.background=i["".concat(a+1).concat(l).concat(o)],this.background,$(this,l),s=H(l),(y=this.walls).push.apply(y,b(s)),n["".concat(this.nodePos)]=this}else if((a=Y(f.length))===f.length){var v;o=Math.floor(3*Math.random()),this.background=i["".concat(a).concat(f).concat(o)],s=H(f),(v=this.walls).push.apply(v,b(s)),n["".concat(this.nodePos)]=this}else{var w;G(p);for(var g=0;g<a;g++)l.push(p.pop());l=l.sort().join(""),o=Math.floor(3*Math.random()),this.background=i["".concat(a).concat(l).concat(o)],$(this,l),s=H(l),(w=this.walls).push.apply(w,b(s)),n["".concat(this.nodePos)]=this}this.animatedObjects={},Object.values(this.coins).forEach((function(t){u.animatedObjects["coin-".concat(t.pos)]=t}))}var e,r;return e=t,(r=[{key:"animate",value:function(){this.collect(),Object.values(this.animatedObjects).forEach((function(t){return t.animate()}))}},{key:"collect",value:function(){for(var t=0,e=Object.values(this.coins);t<e.length;t++){var n=e[t];if(n.collect())return delete this.animatedObjects["coin-".concat(n.pos)],delete this.coins["".concat(n.pos)],void o.coinCount++}}},{key:"draw",value:function(t){t.drawImage(this.background,0,0),Object.values(this.animatedObjects).forEach((function(e){return e.draw(t)})),t.fillStyle="#fffaf4",t.font="20px arial",t.fillText("Room [ ".concat(this.nodePos," ]"),15,30),t.fillText("Coins x ".concat(o.coinCount),590,30)}}])&&w(e.prototype,r),t}();function S(t){return(S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function O(t,e){return(O=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function k(t,e){return!e||"object"!==S(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function j(t){return(j=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function A(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}function C(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function x(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function P(t,e,n){return e&&x(t.prototype,e),n&&x(t,n),t}const B=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&O(t,e)}(i,t);var e,n,r=(e=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,o=j(e);if(n){var r=j(this).constructor;t=Reflect.construct(o,arguments,r)}else t=o.apply(this,arguments);return k(this,t)});function i(t,e,n,o){var s;return C(this,i),(s=r.call(this,t,e,n,o)).frameInterval=12,s.frameCount=0,s.drawOptions.palY=0,s}return P(i,[{key:"collect",value:function(){return!!(this.collidedOnSide("top",o.game.player)||this.collidedOnSide("bottom",o.game.player)||this.collidedOnSide("left",o.game.player)||this.collidedOnSide("right",o.game.player))&&(F().play(),!0)}},{key:"animate",value:function(){var t=this.frameInterval,e=this.frameCount,n=this.width;e<t?(this.drawOptions.palX=0*n,this.frameCount++):e<2*t?(this.drawOptions.palX=1*n,this.frameCount++):e<3*t?(this.drawOptions.palX=2*n,this.frameCount++):e<4*t?(this.drawOptions.palX=3*n,this.frameCount++):e<5*t?(this.drawOptions.palX=4*n,this.frameCount++):e<6*t?(this.drawOptions.palX=5*n,this.frameCount++):e<7*t?(this.drawOptions.palX=6*n,this.frameCount++):e<8*t?(this.drawOptions.palX=7*n,this.frameCount++):(this.drawOptions.palX=0*n,this.frameCount=0)}}]),i}(function(){function t(e,n,o,r){C(this,t),this.pos=e,this.width=n,this.height=o;var i=n,s=o;this.spritePalette=r,this.drawOptions={image:r,palX:0,palY:0,_sWidth:n,_sHeight:o,x:e[0],y:e[1],_dWidth:n,_dHeight:o},this.colBox=new f(this,i,s),this.top=this.colBox.top,this.bottom=this.colBox.bottom,this.left=this.colBox.left,this.right=this.colBox.right,this.collisions={top:!1,bottom:!1,left:!1,right:!1}}return P(t,[{key:"colBoxHook",value:function(){var t=[this.pos[0],this.pos[1]],e=t[1];return[t[0]+(this.width-this.colBox.width)/2,e+(this.height-this.colBox.height)]}},{key:"updateSides",value:function(){this.colBox.updateSides(),this.top=this.colBox.top,this.bottom=this.colBox.bottom,this.left=this.colBox.left,this.right=this.colBox.right}},{key:"collidedOnSide",value:function(t,e){var n;switch(t){case"top":n="bottom";break;case"bottom":n="top";break;case"left":n="right";break;case"right":n="left";break;default:n=null}return this.collisions[t]=T(t,this[t],e[n]),this.collisions[t]}},{key:"draw",value:function(t){var e;t.drawImage.apply(t,function(t){if(Array.isArray(t))return A(t)}(e=Object.values(this.drawOptions))||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(e)||function(t,e){if(t){if("string"==typeof t)return A(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?A(t,e):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),this.colBox.centerOnEntity(),this.colBox.draw(t)}}]),t}());function I(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=t&&("undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"]);if(null!=n){var o,r,i=[],s=!0,a=!1;try{for(n=n.call(t);!(s=(o=n.next()).done)&&(i.push(o.value),!e||i.length!==e);s=!0);}catch(t){a=!0,r=t}finally{try{s||null==n.return||n.return()}finally{if(a)throw r}}return i}}(t,e)||_(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function M(t,e,n){return(M=E()?Reflect.construct:function(t,e,n){var o=[null];o.push.apply(o,e);var r=new(Function.bind.apply(t,o));return n&&R(r,n.prototype),r}).apply(null,arguments)}function E(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function R(t,e){return(R=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function L(t){return function(t){if(Array.isArray(t))return X(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||_(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _(t,e){if(t){if("string"==typeof t)return X(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?X(t,e):void 0}}function X(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}var U=function(){if(o.game)for(var t in o.game.stop(),delete o.game,delete o.player,delete o.coinCount,n)delete n["".concat(t.nodePos)];M(ct,L(Object.values(u)))},T=function(t,e,n){var o,r,i=!1;if("top"===t||"bottom"===t){var s=e[1],a=I(e[0],2),u=a[0],h=a[1],c=n[1],l=I(n[0],2),f=l[0],p=l[1];switch(t){case"top":o=c-s<10,r=c-s>0,i=s<c&&u<p&&h>f&&o&&r;break;case"bottom":o=s-c<10,r=s-c>0,i=s>c&&u<p&&h>f&&o&&r}if(i)return c}else{var d=e[0],y=I(e[1],2),m=y[0],b=y[1],v=n[0],w=I(n[1],2),g=w[0],S=w[1];switch(t){case"left":o=v-d<10,r=v-d>0,i=d<v&&m<S&&b>g&&o&&r;break;case"right":o=d-v<10,r=d-v>0,i=d>v&&m<S&&b>g&&o&&r}if(i)return v}return!1},D=function(t,e){var r,i,s,a=L(e.nodePos);switch(t){case"up":a[1]+=1;break;case"down":a[1]-=1;break;case"left":a[0]-=1;break;case"right":a[0]+=1}if(n["".concat(a)])o.game.room=n["".concat(a)];else{var u=(s=e,(i=t)in(r={})?Object.defineProperty(r,i,{value:s,enumerable:!0,configurable:!0,writable:!0}):r[i]=s,r);o.game.room=new g(u),q(e),q(o.game.room)}},Y=function(t){var e=[];if(t>3){for(var n=0;n<a[t][4];n++)e.push(4);for(var o=0;o<a[t][3];o++)e.push(3);for(var r=0;r<a[t][2];r++)e.push(2);for(var i=0;i<a[t][1];i++)e.push(1)}else if(t>2){for(var s=0;s<a[t][3];s++)e.push(3);for(var u=0;u<a[t][2];u++)e.push(2);for(var h=0;h<a[t][1];h++)e.push(1)}else if(t>1){for(var c=0;c<a[t][2];c++)e.push(2);for(var l=0;l<a[t][1];l++)e.push(1)}else e.push(1);return G(e),e[Math.floor(Math.random()*e.length)]},q=function(t){var e=L(t.nodePos);e[1]+=1,e=e.toString();var o=L(t.nodePos);o[1]-=1,o=o.toString();var r=L(t.nodePos);r[0]-=1,r=r.toString();var i=L(t.nodePos);i[0]+=1,i=i.toString(),n[e]&&"X"!==n[e].neighbors.down&&!t.neighbors.up&&(t.neighbors.up=n[e],n[e].neighbors.down=t),n[o]&&"X"!==n[o].neighbors.up&&!t.neighbors.down&&(t.neighbors.down=n[o],n[o].neighbors.up=t),n[r]&&"X"!==n[r].neighbors.right&&!t.neighbors.left&&(t.neighbors.left=n[r],n[r].neighbors.right=t),n[i]&&"X"!==n[i].neighbors.left&&!t.neighbors.right&&(t.neighbors.right=n[i],n[i].neighbors.left=t)},z=function(t){var e=[],o=L(t.nodePos);o[1]+=1,o=o.toString();var r=L(t.nodePos);r[1]-=1,r=r.toString();var i=L(t.nodePos);i[0]-=1,i=i.toString();var s=L(t.nodePos);return s[0]+=1,s=s.toString(),n[o]&&"X"===n[o].neighbors.down||e.push("U"),n[r]&&"X"===n[r].neighbors.up||e.push("D"),n[i]&&"X"===n[i].neighbors.right||e.push("L"),n[s]&&"X"===n[s].neighbors.left||e.push("R"),e.sort().join("")},$=function(t,e){e.includes("U")||(t.neighbors.up="X"),e.includes("D")||(t.neighbors.down="X"),e.includes("L")||(t.neighbors.left="X"),e.includes("R")||(t.neighbors.right="X")},H=function(t){var e=[];switch(t){case"DLRU":return e.push(new m([0,0],288,48)),e.push(new m([432,0],288,48)),e.push(new m([0,672],288,48)),e.push(new m([432,672],288,48)),e.push(new m([0,0],48,288)),e.push(new m([0,432],48,288)),e.push(new m([672,0],48,288)),e.push(new m([672,432],48,288)),e;case"DLU":return e.push(new m([0,0],288,48)),e.push(new m([432,0],288,48)),e.push(new m([0,672],288,48)),e.push(new m([432,672],288,48)),e.push(new m([0,0],48,288)),e.push(new m([0,432],48,288)),e.push(new m([672,0],48,720)),e;case"LRU":return e.push(new m([0,0],288,48)),e.push(new m([432,0],288,48)),e.push(new m([0,0],48,288)),e.push(new m([0,432],48,288)),e.push(new m([672,0],48,288)),e.push(new m([672,432],48,288)),e.push(new m([0,672],720,48)),e;case"DRU":return e.push(new m([0,0],288,48)),e.push(new m([432,0],288,48)),e.push(new m([0,672],288,48)),e.push(new m([432,672],288,48)),e.push(new m([672,0],48,288)),e.push(new m([672,432],48,288)),e.push(new m([0,0],48,720)),e;case"DLR":return e.push(new m([0,672],288,48)),e.push(new m([432,672],288,48)),e.push(new m([0,0],48,288)),e.push(new m([0,432],48,288)),e.push(new m([672,0],48,288)),e.push(new m([672,432],48,288)),e.push(new m([0,0],720,48)),e;case"LU":return e.push(new m([0,0],48,288)),e.push(new m([0,432],48,288)),e.push(new m([0,0],288,48)),e.push(new m([432,0],288,48)),e.push(new m([672,0],48,720)),e.push(new m([0,672],720,48)),e;case"DU":return e.push(new m([0,0],288,48)),e.push(new m([432,0],288,48)),e.push(new m([0,672],288,48)),e.push(new m([432,672],288,48)),e.push(new m([0,0],48,720)),e.push(new m([672,0],48,720)),e;case"RU":return e.push(new m([672,0],48,288)),e.push(new m([672,432],48,288)),e.push(new m([0,0],288,48)),e.push(new m([432,0],288,48)),e.push(new m([0,672],720,48)),e.push(new m([0,0],48,720)),e;case"DL":return e.push(new m([0,0],48,288)),e.push(new m([0,432],48,288)),e.push(new m([0,672],288,48)),e.push(new m([432,672],288,48)),e.push(new m([0,0],720,48)),e.push(new m([672,0],48,720)),e;case"DR":return e.push(new m([672,0],48,288)),e.push(new m([672,432],48,288)),e.push(new m([0,672],288,48)),e.push(new m([432,672],288,48)),e.push(new m([0,0],48,720)),e.push(new m([0,0],720,48)),e;case"LR":return e.push(new m([0,0],48,288)),e.push(new m([0,432],48,288)),e.push(new m([672,0],48,288)),e.push(new m([672,432],48,288)),e.push(new m([0,672],720,48)),e.push(new m([0,0],720,48)),e}},F=function(){var t=Math.floor(9*Math.random());return document.getElementById("coin".concat(t))},W=function(){for(var t=function(){for(var t=[],e=0;e<10;e++)t.push(3);for(var n=0;n<20;n++)t.push(2);for(var o=0;o<30;o++)t.push(1);for(var r=0;r<20;r++)t.push(0);var i=Math.floor(Math.random()*t.length);return G(t),t[i]}(),e={},n=0;n<t;n++){for(var o=Math.floor(592*Math.random())+64;o>336&&o<384;)o=Math.floor(592*Math.random())+64;for(var i=Math.floor(592*Math.random())+64;i>336&&i<384;)i=Math.floor(592*Math.random())+64;var s=new B([o,i],16,16,r.coin);e["".concat(s.pos)]=s}return e},G=function(t){for(var e=t.length-1;e>0;e--){var n=Math.floor(Math.random()*(e+1)),o=[t[n],t[e]];t[e]=o[0],t[n]=o[1]}};function J(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}function K(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function N(t){return(N="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Q(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=V(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var o=0,r=function(){};return{s:r,n:function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,a=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return s=t.done,t},e:function(t){a=!0,i=t},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw i}}}}function V(t,e){if(t){if("string"==typeof t)return Z(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Z(t,e):void 0}}function Z(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}function tt(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function et(t,e){return(et=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function nt(t,e){return!e||"object"!==N(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ot(t){return(ot=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}const rt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&et(t,e)}(u,t);var n,r,i,s,a=(i=u,s=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=ot(i);if(s){var n=ot(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return nt(this,t)});function u(t,e,n,o){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),(r=a.call(this,t,e,n,o)).speed=1,r.normalizedSpeed=parseFloat(r.speed)/Math.sqrt(2),r.pace=24/r.speed,r.speedModifier=1,r.stride={up:{stepCount:0,palY:288},down:{stepCount:0,palY:0},left:{stepCount:0,palY:96},right:{stepCount:0,palY:192}},r}return n=u,(r=[{key:"newRoomPos",value:function(t){switch(t){case"up":this.pos[1]=696;break;case"down":this.pos[1]=-24;break;case"left":this.pos[0]=696;break;case"right":this.pos[0]=-24}}},{key:"stridePalettePos",value:function(t){return this.pace=24/(this.speed*this.speedModifier),this.stride[t].stepCount<=this.pace?(this.stride[t].stepCount++,48):this.stride[t].stepCount<=2*this.pace?(this.stride[t].stepCount++,0):this.stride[t].stepCount<=3*this.pace?(this.stride[t].stepCount++,48):this.stride[t].stepCount<=4*this.pace?(this.stride[t].stepCount++,96):this.stride[t].stepCount>4*this.pace?(this.stride[t].stepCount=0,48):void 0}},{key:"move",value:function(t){var n=[e[87],e[83],e[65],e[68],e[16]],r=n[0],i=n[1],s=n[2],a=n[3],u=n[4];if(this.speedModifier=u?2:1,r){this.colBox.pos[1]+=s||a?-this.normalizedSpeed*this.speedModifier:-this.speed*this.speedModifier,this.updateSides();var h,c=Q(t);try{for(c.s();!(h=c.n()).done;){var l=h.value;if(this.collidedOnSide("top",l))break}}catch(t){c.e(t)}finally{c.f()}this.collisions.top?this.pos[1]=this.collisions.top-(this.height-this.colBox.height):s||a&&!this.collisions.top?(this.pos[1]+=-this.normalizedSpeed*this.speedModifier,this.updateSides()):(this.pos[1]+=-this.speed*this.speedModifier,this.updateSides()),this.drawOptions.palY=this.stride.up.palY,s||a||(this.drawOptions.palX=this.stridePalettePos("up"))}if(i){this.colBox.pos[1]+=s||a?this.normalizedSpeed*this.speedModifier:this.speed*this.speedModifier,this.updateSides();var f,p=Q(t);try{for(p.s();!(f=p.n()).done;){var d=f.value;if(this.collidedOnSide("bottom",d))break}}catch(t){p.e(t)}finally{p.f()}this.collisions.bottom?(this.colBox.pos[1]=this.collisions.bottom,this.pos[1]=this.collisions.bottom-48):s||a?(this.pos[1]+=this.normalizedSpeed*this.speedModifier,this.updateSides()):(this.pos[1]+=this.speed*this.speedModifier,this.updateSides()),this.drawOptions.palY=this.stride.down.palY,s||a||(this.drawOptions.palX=this.stridePalettePos("down"))}if(s){this.colBox.pos[0]+=r||i?-this.normalizedSpeed*this.speedModifier:-this.speed*this.speedModifier,this.updateSides();var y,m=Q(t);try{for(m.s();!(y=m.n()).done;){var b=y.value;if(this.collidedOnSide("left",b))break}}catch(t){m.e(t)}finally{m.f()}this.collisions.left?this.colBox.pos[0]=this.collisions.left:r||i&&!this.collisions.left?this.pos[0]+=-this.normalizedSpeed*this.speedModifier:this.pos[0]+=-this.speed*this.speedModifier,this.drawOptions.palY=this.stride.left.palY,this.drawOptions.palX=this.stridePalettePos("left")}if(a){this.colBox.pos[0]+=r||i?this.normalizedSpeed*this.speedModifier:this.speed*this.speedModifier,this.updateSides();var v,w=Q(t);try{for(w.s();!(v=w.n()).done;){var g=v.value;if(this.collidedOnSide("right",g))break}}catch(t){w.e(t)}finally{w.f()}this.collisions.right?(this.colBox.pos[0]=this.collisions.right,this.pos[0]=this.collisions.right-(this.colBox.width+this.colBox.width/2)):r||i?(this.pos[0]+=this.normalizedSpeed*this.speedModifier,this.updateSides()):(this.pos[0]+=this.speed*this.speedModifier,this.updateSides()),this.drawOptions.palY=this.stride.right.palY,this.drawOptions.palX=this.stridePalettePos("right")}r||i||a||s||(this.drawOptions.palX=48);var S,O,k,j=(O=this.pos,k=2,function(t){if(Array.isArray(t))return t}(O)||function(t,e){var n=t&&("undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"]);if(null!=n){var o,r,i=[],s=!0,a=!1;try{for(n=n.call(t);!(s=(o=n.next()).done)&&(i.push(o.value),!e||i.length!==e);s=!0);}catch(t){a=!0,r=t}finally{try{s||null==n.return||n.return()}finally{if(a)throw r}}return i}}(O,k)||V(O,k)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),A=j[0],C=j[1];A<-24?(S="left",this.newRoomPos(S),D(S,o.game.room)):A>696?(S="right",this.newRoomPos(S),D(S,o.game.room)):C<-24?(S="up",this.newRoomPos(S),D(S,o.game.room)):C>696&&(S="down",this.newRoomPos(S),D(S,o.game.room)),this.updateSides(),this.drawOptions.x=this.pos[0],this.drawOptions.y=this.pos[1]}}])&&tt(n.prototype,r),u}(function(){function t(e,n,o,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.pos=e,this.width=n,this.height=o;var i=n/2,s=o/3;this.spritePalette=r,this.drawOptions={image:r,palX:0,palY:0,_sWidth:n,_sHeight:o,x:e[0],y:e[1],_dWidth:n,_dHeight:o},this.colBox=new f(this,i,s),this.top=this.colBox.top,this.bottom=this.colBox.bottom,this.left=this.colBox.left,this.right=this.colBox.right,this.collisions={top:!1,bottom:!1,left:!1,right:!1}}var e,n;return e=t,(n=[{key:"colBoxHook",value:function(){var t=[this.pos[0],this.pos[1]],e=t[1];return[t[0]+(this.width-this.colBox.width)/2,e+(this.height-this.colBox.height)]}},{key:"updateSides",value:function(){this.colBox.updateSides(),this.top=this.colBox.top,this.bottom=this.colBox.bottom,this.left=this.colBox.left,this.right=this.colBox.right}},{key:"collidedOnSide",value:function(t,e){var n;switch(t){case"top":n="bottom";break;case"bottom":n="top";break;case"left":n="right";break;case"right":n="left";break;default:n=null}return this.collisions[t]=T(t,this[t],e[n]),this.collisions[t]}},{key:"draw",value:function(t){var e;t.drawImage.apply(t,function(t){if(Array.isArray(t))return J(t)}(e=Object.values(this.drawOptions))||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(e)||function(t,e){if(t){if("string"==typeof t)return J(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?J(t,e):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),this.colBox.centerOnEntity(),this.colBox.draw(t)}}])&&K(e.prototype,n),t}());function it(t,e,n){return(it=st()?Reflect.construct:function(t,e,n){var o=[null];o.push.apply(o,e);var r=new(Function.bind.apply(t,o));return n&&at(r,n.prototype),r}).apply(null,arguments)}function st(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function at(t,e){return(at=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function ut(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}function ht(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}const ct=function(){function e(n,r){var i;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.player=it(rt,[[336,336]].concat(function(t){if(Array.isArray(t))return ut(t)}(i=t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(i)||function(t,e){if(t){if("string"==typeof t)return ut(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ut(t,e):void 0}}(i)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),[r])),o.player=this.player,this.ctx=n,this.startingRoom=new g,this.room=this.startingRoom,this.player.draw(n),o.game=this,o.stop=!1,o.coinCount=0,this.gameStep=this.gameStep.bind(this),this.stop=this.stop.bind(this),o.game.play()}var n,r;return n=e,(r=[{key:"stop",value:function(){this.requestId&&(this.requestStop=!0)}},{key:"gameStep",value:function(){if(this.requestId=void 0,!this.requestId){var t=o.player;if(this.ctx.clearRect(0,0,720,720),t.move(this.room.walls),this.room.animate(),this.room.draw(this.ctx),t.draw(this.ctx),this.requestId=requestAnimationFrame(this.gameStep),this.requestStop)return void cancelAnimationFrame(this.requestId)}}},{key:"play",value:function(){this.gameStep(),requestAnimationFrame(this.gameStep)}}])&&ht(n.prototype,r),e}();function lt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}document.addEventListener("DOMContentLoaded",(function(){var t=document.getElementById("display");t.width=720,t.height=720;var n=t.getContext("2d");!function(t){document.addEventListener("keydown",(function(e){87!==e.keyCode||t[87]||(t[e.keyCode]=!0),65!==e.keyCode||t[65]||(t[e.keyCode]=!0),83!==e.keyCode||t[83]||(t[e.keyCode]=!0),68!==e.keyCode||t[68]||(t[e.keyCode]=!0),16!==e.keyCode||t[16]||(t[e.keyCode]=!0)})),document.addEventListener("keyup",(function(e){87===e.keyCode&&t[87]&&(t[e.keyCode]=!1),65===e.keyCode&&t[65]&&(t[e.keyCode]=!1),83===e.keyCode&&t[83]&&(t[e.keyCode]=!1),68===e.keyCode&&t[68]&&(t[e.keyCode]=!1),16===e.keyCode&&t[16]&&(t[e.keyCode]=!1)}));var e=document.getElementById("how-to");e.addEventListener("mouseenter",(function(t){document.getElementById("how-to-pointer").classList.add("active"),document.getElementById("how-to-sound").play(),document.getElementById("how-to").classList.add("active"),document.querySelector("#how-to > ul").classList.add("active")})),e.addEventListener("mouseleave",(function(t){document.getElementById("how-to").classList.remove("active"),document.getElementById("how-to-pointer").classList.remove("active"),document.querySelector("#how-to > ul").classList.remove("active")}));var n=document.getElementById("restart");n.addEventListener("mouseenter",(function(t){document.getElementById("restart-sound").play(),document.getElementById("restart").classList.add("active"),document.getElementById("restart-pointer").classList.add("active")})),n.addEventListener("mouseleave",(function(t){document.getElementById("restart").classList.remove("active"),document.getElementById("restart-pointer").classList.remove("active")})),n.addEventListener("click",(function(t){t.preventDefault(),U()}))}(e);var o=new Image;o.src="dist/src/assets/images/coin/coin.png",o.onload=function(){r.coin=o};var a,h=function(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return lt(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?lt(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var o=0,r=function(){};return{s:r,n:function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,a=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return s=t.done,t},e:function(t){a=!0,i=t},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw i}}}}(s);try{var c=function(){var t=a.value;t=t.split("").sort().join("");for(var e=function(e){var n=new Image;n.src="./src/assets/images/map_imgs/".concat(t.length,"/").concat(t,"/map").concat(e,".png"),n.onload=function(){i["".concat(t.length).concat(t).concat(e)]=n}},n=0;n<3;n++)e(n)};for(h.s();!(a=h.n()).done;)c()}catch(t){h.e(t)}finally{h.f()}var l=new Image;l.src="dist/src/assets/images/rogue/rogue_walk.png",l.onload=function(){setTimeout((function(){u.ctx=n,u.playerSprite=l,U()}),1e3)}}))})();
//# sourceMappingURL=main.js.map